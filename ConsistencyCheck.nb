(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     69812,       1801]
NotebookOptionsPosition[     67510,       1757]
NotebookOutlinePosition[     67915,       1773]
CellTagsIndexPosition[     67872,       1770]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Algorithmically", " ", "generate", " ", "the", " ", "rational", " ", 
   "function", " ", 
   RowBox[{"E", "/", "F"}], " ", "of", " ", "Section", " ", "3.4"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9038867781784935`*^9, 3.9038867988876724`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b83518cd-3f38-4a2a-a3ea-bc9b5109c4dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "the", " ", "leftmost", " ", "matrix", " ", "of", " ", 
    "Lemma", " ", "7"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Mat", " ", "=", " ", GridBox[{
       {"q21", "q22", 
        RowBox[{"-", "q11"}], 
        RowBox[{"-", "q12"}], "0", "0", "0", "0"},
       {"q31", "q32", "0", "0", 
        RowBox[{"-", "q11"}], 
        RowBox[{"-", "q12"}], "0", "0"},
       {"q41", "q42", "0", "0", "0", "0", 
        RowBox[{"-", "q11"}], 
        RowBox[{"-", "q12"}]},
       {"0", "0", "q31", "q32", 
        RowBox[{"-", "q21"}], 
        RowBox[{"-", "q22"}], "0", "0"},
       {"0", "0", "q41", "q42", "0", "0", 
        RowBox[{"-", "q21"}], 
        RowBox[{"-", "q22"}]},
       {"0", "0", "0", "0", "q41", "q42", 
        RowBox[{"-", "q31"}], 
        RowBox[{"-", "q32"}]}
      }]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{"Mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Define", " ", 
     RowBox[{"the", " ", "\\", "Phi"}], " ", "matrices", " ", 
     RowBox[{"(", 
      RowBox[{"here", " ", "labelled", " ", "D"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D1", " ", "=", GridBox[{
       {"d11", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "d13"}]},
       {
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "d13"}], "d12"}
      }]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D2", "=", " ", GridBox[{
       {"d21", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "d23"}]},
       {
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "d23"}], "d22"}
      }]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D3", "=", GridBox[{
       {"d31", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "d33"}]},
       {
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "d33"}], "d32"}
      }]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D4", "=", GridBox[{
       {"d41", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "d43"}]},
       {
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "d43"}], "d42"}
      }]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Define", " ", "the", " ", "list", " ", 
     RowBox[{"of", " ", "\\", "Phi"}], " ", "matrices"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dmat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"D1", ",", "D2", ",", "D3", ",", "D4"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Define", " ", "the", " ", "list", " ", "of", " ", "q", " ", "vectors"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q11", ",", "q12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q21", ",", "q22"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q31", ",", "q32"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q41", ",", "q42"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.886604225397937*^9, 3.886604297431221*^9}, {
   3.9038860305738893`*^9, 3.90388613812836*^9}, {3.903886186296741*^9, 
   3.9038861951423597`*^9}, 3.9038862977233343`*^9, {3.9038864267480273`*^9, 
   3.9038864358707466`*^9}, {3.9038865392289257`*^9, 
   3.9038866011087427`*^9}, {3.9253113569573517`*^9, 3.92531136099189*^9}, {
   3.925576380510543*^9, 3.92557638402304*^9}, {3.92559751343163*^9, 
   3.925597515885585*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"5379b353-df5b-421a-a41c-5a288af45ec0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"q21", "q22", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0", "0", "0"},
     {"q31", "q32", "0", "0", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0"},
     {"q41", "q42", "0", "0", "0", "0", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}]},
     {"0", "0", "q31", "q32", 
      RowBox[{"-", "q21"}], 
      RowBox[{"-", "q22"}], "0", "0"},
     {"0", "0", "q41", "q42", "0", "0", 
      RowBox[{"-", "q21"}], 
      RowBox[{"-", "q22"}]},
     {"0", "0", "0", "0", "q41", "q42", 
      RowBox[{"-", "q31"}], 
      RowBox[{"-", "q32"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.925576384710387*^9, {3.925588479457233*^9, 3.9255884837662888`*^9}, {
   3.925588530948083*^9, 3.925588539026181*^9}, {3.925597517007888*^9, 
   3.9255975230034437`*^9}, 3.925639743924065*^9},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"c9c67863-3b09-4c1f-8a11-\
279b047b2935"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "the", " ", "constants", " ", "c_ij"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", " ", "==", " ", "1"}], " ", "&&", " ", 
         RowBox[{"j", " ", "==", " ", "2"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", " ", "==", " ", "3"}], " ", "&&", " ", 
         RowBox[{"j", " ", "==", " ", "4"}]}], ")"}]}], ",", "1", ",", "0"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Define", " ", "star", " ", "operator", " ", "giving", " ", "the", " ", 
     "entries", " ", "of", " ", "the", " ", "rightmost", " ", "matrix", " ", 
     "of", " ", "Lemma", " ", "7"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"star", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Transpose]"}], ".", 
      RowBox[{"Dmat", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ".", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "\[Transpose]"}], ".", 
      RowBox[{"Dmat", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8866023173684397`*^9, 3.8866023938899837`*^9}, {
   3.887284843550256*^9, 3.8872848682858753`*^9}, {3.8872934975655537`*^9, 
   3.8872935035707893`*^9}, {3.9038866103436184`*^9, 
   3.9038866280637493`*^9}, {3.903886660302856*^9, 3.9038866692542543`*^9}, {
   3.9038867253590975`*^9, 3.9038867387345524`*^9}, {3.903887025031129*^9, 
   3.903887026189701*^9}, {3.903887057859211*^9, 3.903887059545788*^9}, 
   3.9038876083625736`*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"7bf4ba82-2376-410a-9607-2bb0a710f38a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Symbolically", " ", "compute", " ", "the", " ", "6"}], "-", 
    RowBox[{
    "minors", " ", "of", " ", "Mat", " ", "to", " ", "show", " ", "it", " ", 
     "has", " ", "rank", " ", "at", " ", "most", " ", "5"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Minors", "[", 
   RowBox[{"Mat", ",", "6"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9039805134241333`*^9, 3.903980537316265*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"2243a51f-9afc-44e3-b25a-4d617b8c0633"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.903980556307483*^9, 3.9253113303474483`*^9, {3.925311365794346*^9, 
   3.9253113814648943`*^9}, {3.925312922799786*^9, 3.925312944548826*^9}, 
   3.925588487851035*^9, 3.9255885430047493`*^9, 3.92559753410916*^9, 
   3.925639749272936*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"56ae167d-d612-4401-b651-6efb0ce79c3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "rightmost", " ", "matrix", " ", "of", " ", "Lemma", " ", 
    "7"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"b", " ", "=", " ", 
     RowBox[{"star", " ", "@@@", " ", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Range", "[", "4", "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"b", " ", "//", " ", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.88660252707932*^9, 3.8866025602800474`*^9}, {
  3.886602837327635*^9, 3.8866028414301586`*^9}, {3.887280950508357*^9, 
  3.8872809657180643`*^9}, {3.8915938375727253`*^9, 3.8915938381620913`*^9}, {
  3.9038865279465156`*^9, 3.9038865299259863`*^9}, {3.9038866519546194`*^9, 
  3.9038866543847218`*^9}, {3.9038870379247017`*^9, 3.9038870525636663`*^9}, {
  3.903887184513887*^9, 3.903887195432192*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"c9e6775f-d92f-4489-8ecf-5a7fad82785a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"1", "-", 
        RowBox[{"q12", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d23", " ", "q11"}], "2"], "+", 
           RowBox[{"d22", " ", "q12"}]}], ")"}]}], "-", 
        RowBox[{"q11", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d21", " ", "q11"}], "+", 
           FractionBox[
            RowBox[{"d23", " ", "q12"}], "2"]}], ")"}]}], "+", 
        RowBox[{"q22", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d13", " ", "q21"}], "2"], "+", 
           RowBox[{"d12", " ", "q22"}]}], ")"}]}], "+", 
        RowBox[{"q21", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d11", " ", "q21"}], "+", 
           FractionBox[
            RowBox[{"d13", " ", "q22"}], "2"]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "q12"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d33", " ", "q11"}], "2"], "+", 
           RowBox[{"d32", " ", "q12"}]}], ")"}]}], "-", 
        RowBox[{"q11", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d31", " ", "q11"}], "+", 
           FractionBox[
            RowBox[{"d33", " ", "q12"}], "2"]}], ")"}]}], "+", 
        RowBox[{"q32", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d13", " ", "q31"}], "2"], "+", 
           RowBox[{"d12", " ", "q32"}]}], ")"}]}], "+", 
        RowBox[{"q31", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d11", " ", "q31"}], "+", 
           FractionBox[
            RowBox[{"d13", " ", "q32"}], "2"]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "q12"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d43", " ", "q11"}], "2"], "+", 
           RowBox[{"d42", " ", "q12"}]}], ")"}]}], "-", 
        RowBox[{"q11", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d41", " ", "q11"}], "+", 
           FractionBox[
            RowBox[{"d43", " ", "q12"}], "2"]}], ")"}]}], "+", 
        RowBox[{"q42", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d13", " ", "q41"}], "2"], "+", 
           RowBox[{"d12", " ", "q42"}]}], ")"}]}], "+", 
        RowBox[{"q41", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d11", " ", "q41"}], "+", 
           FractionBox[
            RowBox[{"d13", " ", "q42"}], "2"]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "q22"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d33", " ", "q21"}], "2"], "+", 
           RowBox[{"d32", " ", "q22"}]}], ")"}]}], "-", 
        RowBox[{"q21", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d31", " ", "q21"}], "+", 
           FractionBox[
            RowBox[{"d33", " ", "q22"}], "2"]}], ")"}]}], "+", 
        RowBox[{"q32", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d23", " ", "q31"}], "2"], "+", 
           RowBox[{"d22", " ", "q32"}]}], ")"}]}], "+", 
        RowBox[{"q31", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d21", " ", "q31"}], "+", 
           FractionBox[
            RowBox[{"d23", " ", "q32"}], "2"]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "q22"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d43", " ", "q21"}], "2"], "+", 
           RowBox[{"d42", " ", "q22"}]}], ")"}]}], "-", 
        RowBox[{"q21", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d41", " ", "q21"}], "+", 
           FractionBox[
            RowBox[{"d43", " ", "q22"}], "2"]}], ")"}]}], "+", 
        RowBox[{"q42", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d23", " ", "q41"}], "2"], "+", 
           RowBox[{"d22", " ", "q42"}]}], ")"}]}], "+", 
        RowBox[{"q41", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d21", " ", "q41"}], "+", 
           FractionBox[
            RowBox[{"d23", " ", "q42"}], "2"]}], ")"}]}]}]},
      {
       RowBox[{"1", "-", 
        RowBox[{"q32", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d43", " ", "q31"}], "2"], "+", 
           RowBox[{"d42", " ", "q32"}]}], ")"}]}], "-", 
        RowBox[{"q31", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d41", " ", "q31"}], "+", 
           FractionBox[
            RowBox[{"d43", " ", "q32"}], "2"]}], ")"}]}], "+", 
        RowBox[{"q42", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d33", " ", "q41"}], "2"], "+", 
           RowBox[{"d32", " ", "q42"}]}], ")"}]}], "+", 
        RowBox[{"q41", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d31", " ", "q41"}], "+", 
           FractionBox[
            RowBox[{"d33", " ", "q42"}], "2"]}], ")"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.903980556358824*^9, 3.92531133226444*^9, {3.925311367626855*^9, 
   3.925311383406045*^9}, {3.925312922814671*^9, 3.9253129445758038`*^9}, 
   3.925588490078656*^9, 3.9255885444069023`*^9, 3.925597535845532*^9, 
   3.9256397512445917`*^9},
 CellLabel->
  "Out[23]//MatrixForm=",ExpressionUUID->"29b4eb5a-25f0-410d-8d08-\
d054b1779725"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "and", " ", "symbolically", " ", "row", " ", "reduce", 
    " ", "the", " ", "augmented", " ", "matrix", " ", "of", " ", "Lemma", " ",
     "7"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"Mat", ",", " ", 
       RowBox[{"IdentityMatrix", "[", "6", "]"}], ",", " ", "2"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"A", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "We", " ", "manually", " ", "perform", " ", "a", " ", "symbolic", " ", 
      "row", " ", "reduction", " ", "on", " ", "A", " ", "to", " ", "a", " ", 
      "RE", " ", "form", " ", "in", " ", "such", " ", "a", " ", "way", " ", 
      "that", " ", "we", " ", "only", " ", "need", " ", "to", " ", "invert", 
      " ", "q31", "*", "q42"}], "-", 
     RowBox[{"q32", "*", "q41", " ", "in", " ", "the", " ", "process"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Shift", " ", "rows", " ", "cyclically", " ", "one", " ", "position", " ",
      "up"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
        "}"}], "]"}], "]"}], "=", 
     RowBox[{"A", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "1"}], 
        "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"A", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Now", " ", "we", " ", "assume", " ", "the", " ", "2", " ", "by", " ", 
      "2", " ", "block", " ", "Q"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q31", ",", "q32"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q41", ",", "q42"}], "}"}]}], "}"}], " ", "has", " ", 
       "non"}], "-", 
      RowBox[{"zero", " ", "determinant", " ", "so", " ", "is", " ", 
       RowBox[{"invertible", ".", " ", "This"}], " ", "assumption", " ", 
       "also", " ", "means", " ", "that", " ", "q41", " ", "and", " ", "q42", 
       " ", "are", " ", "not", " ", "both", " ", 
       RowBox[{"zero", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q31", ",", "q32"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q41", ",", "q42"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "We", " ", "multiply", " ", "on", " ", "the", " ", "left", " ", "by", 
      " ", "the", " ", "inverse", " ", "of", " ", "the", " ", "block", " ", 
      "diagonal", " ", "matrix", " ", "with", " ", "blocks", " ", "Q"}], ",", 
     " ", "Q", ",", " ", 
     RowBox[{
      RowBox[{"I", ".", " ", "As"}], " ", "this", " ", "matrix", " ", "is", 
      " ", "invertible"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "a", " ", "product", " ", "of", " ", "elementary", 
      " ", 
      RowBox[{"matrices", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{"BlockDiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Inverse", "[", "Q", "]"}], ",", 
        RowBox[{"Inverse", "[", "Q", "]"}], ",", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"P", ".", "A"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"A1", " ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Add", " ", "multiples", " ", "of", " ", "first", " ", "four", " ", 
     "rows", " ", "to", " ", "last", " ", "row", " ", "to", " ", "zero", " ", 
     "out", " ", "entries", " ", "below", " ", "the", " ", "first", " ", 
     "four", " ", "pivots"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A1", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"A1", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "-", 
      RowBox[{"q21", "*", 
       RowBox[{"A1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "-", 
      RowBox[{"q22", "*", 
       RowBox[{"A1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{"q11", "*", 
       RowBox[{"A1", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "+", 
      RowBox[{"q12", "*", 
       RowBox[{"A1", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", 
     RowBox[{"Simplify", "[", "A1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"A1", " ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Add", " ", "a", " ", "multiple", " ", "of", " ", "row", " ", "5", " ", 
     "to", " ", "row", " ", "6"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A1", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"A1", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q12", "*", "q21"}], "-", 
          RowBox[{"q11", "*", "q22"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q31", "*", "q42"}], "-", 
          RowBox[{"q41", "*", "q32"}]}], ")"}]}], "*", 
       RowBox[{"A1", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "in", " ", "RE", " ", "form", " ", "as", " ", 
     "q41", " ", "and", " ", "q42", " ", "are", " ", "not", " ", "both", " ", 
     "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", 
     RowBox[{"Simplify", "[", "A1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"A1", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", "=", 
     RowBox[{"A1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "6"}], ",", 
        RowBox[{"9", ";;", "14"}]}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Retain", " ", "only", " ", "the", " ", "last", " ", "six", " ", 
     "columns", " ", "of", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"B", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.887291809386951*^9, 3.887291844912786*^9}, {
   3.887292029273325*^9, 3.887292042644075*^9}, {3.887292080613179*^9, 
   3.887292092021269*^9}, {3.887292135286973*^9, 3.887292270931302*^9}, {
   3.887292331937624*^9, 3.8872924052858973`*^9}, {3.887292581013159*^9, 
   3.887292586747925*^9}, {3.9038872037825236`*^9, 3.9038872280221443`*^9}, 
   3.9038873711964035`*^9, {3.903887440013519*^9, 3.9038874522425427`*^9}, {
   3.92531140935312*^9, 3.925311473046073*^9}, {3.925312758464764*^9, 
   3.92531277536309*^9}, {3.9253128129062023`*^9, 3.92531283406733*^9}, {
   3.925313065987233*^9, 3.925313067617594*^9}, {3.925327532031219*^9, 
   3.9253275408886633`*^9}, {3.925577783676578*^9, 3.9255778532253733`*^9}, {
   3.92558845824093*^9, 3.925588469290707*^9}, 3.9255885530202513`*^9, {
   3.92558859367176*^9, 3.925588596420743*^9}, {3.925597546826576*^9, 
   3.9255975486478024`*^9}, {3.925597894955101*^9, 3.9255979085633574`*^9}, {
   3.9255980135989943`*^9, 3.925598183198311*^9}, {3.925598292839713*^9, 
   3.9255984243156967`*^9}, {3.92559846985701*^9, 3.9255985424205914`*^9}, {
   3.925598654613162*^9, 3.925598666586011*^9}, {3.9255987033879766`*^9, 
   3.925598790570548*^9}, {3.925598859053234*^9, 3.92559887875951*^9}, {
   3.9255989585296383`*^9, 3.925598965288621*^9}, {3.925599002522614*^9, 
   3.92559904206745*^9}, {3.9256397135558777`*^9, 3.9256398486948853`*^9}, {
   3.925639949436082*^9, 3.925640021116737*^9}, {3.925640054816657*^9, 
   3.92564005788809*^9}, {3.925640088343337*^9, 3.925640118360956*^9}, {
   3.925640208589035*^9, 3.925640313871283*^9}, {3.925640348293399*^9, 
   3.925640369030827*^9}, {3.925640401191621*^9, 3.9256405045230923`*^9}, {
   3.925640564359737*^9, 3.925640615217449*^9}, {3.925640657648168*^9, 
   3.9256406941997337`*^9}, {3.925641036887783*^9, 3.925641291489356*^9}, {
   3.925641329814328*^9, 3.925641393870882*^9}, {3.925641426380025*^9, 
   3.925641450878112*^9}, {3.925641550584168*^9, 3.925641615472599*^9}, {
   3.925641673549554*^9, 3.9256417219855547`*^9}, {3.9256423259120398`*^9, 
   3.9256423304378*^9}, {3.925642428169806*^9, 3.925642429232957*^9}, {
   3.925642765949751*^9, 3.925642987159658*^9}, {3.925643021427519*^9, 
   3.925643079265658*^9}, {3.925643132235914*^9, 3.9256431726988153`*^9}, {
   3.925643438568185*^9, 3.925643440389278*^9}, {3.925645217745534*^9, 
   3.925645237091901*^9}, {3.925645410488739*^9, 3.925645443897518*^9}, 
   3.9259124786626277`*^9, 
   3.9259125875810513`*^9},ExpressionUUID->"8c05cc0d-c312-4960-86bd-\
da37261b718d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"q21", "q22", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"q31", "q32", "0", "0", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0", "0", "1", "0", "0", "0", "0"},
     {"q41", "q42", "0", "0", "0", "0", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0", "1", "0", "0", "0"},
     {"0", "0", "q31", "q32", 
      RowBox[{"-", "q21"}], 
      RowBox[{"-", "q22"}], "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "q41", "q42", "0", "0", 
      RowBox[{"-", "q21"}], 
      RowBox[{"-", "q22"}], "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "q41", "q42", 
      RowBox[{"-", "q31"}], 
      RowBox[{"-", "q32"}], "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.925577820353684*^9, 3.925588492998931*^9, {3.925588554278919*^9, 
   3.9255885603217487`*^9}, 3.925588597121891*^9, 3.925597550571229*^9, 
   3.9255980692108393`*^9, 3.925598109635578*^9, 3.925598543504778*^9, 
   3.925598667421487*^9, {3.925598952274755*^9, 3.9255990473027163`*^9}, {
   3.925639740412581*^9, 3.925639768186924*^9}, {3.92563979916903*^9, 
   3.9256398497882338`*^9}, {3.92563995972366*^9, 3.9256400216301126`*^9}, 
   3.9256400583213377`*^9, {3.925640091385625*^9, 3.925640119165019*^9}, {
   3.925640233031831*^9, 3.925640314734329*^9}, {3.925640360873233*^9, 
   3.925640373352131*^9}, {3.925640404198275*^9, 3.925640505057993*^9}, {
   3.9256405693971443`*^9, 3.925640617027256*^9}, {3.925640658808957*^9, 
   3.925640694591001*^9}, {3.925641050150668*^9, 3.9256411275316153`*^9}, {
   3.925641209505619*^9, 3.925641229190782*^9}, {3.9256412859217978`*^9, 
   3.925641292233211*^9}, {3.925641330431147*^9, 3.925641352410399*^9}, 
   3.9256413949858828`*^9, {3.9256414377432833`*^9, 3.925641451285645*^9}, 
   3.9256415546024733`*^9, 3.925641618689211*^9, 3.9256417236184683`*^9, {
   3.9256429072215633`*^9, 3.92564291973177*^9}, {3.9256429648358803`*^9, 
   3.92564298771693*^9}, {3.925643140891343*^9, 3.925643176240343*^9}, 
   3.925643440892791*^9, 3.925645180259605*^9, {3.925645225431714*^9, 
   3.925645237510964*^9}, {3.925645412584852*^9, 3.925645444274144*^9}},
 CellLabel->
  "Out[765]//MatrixForm=",ExpressionUUID->"0fb0e066-b1ab-454f-82b8-\
a8558d58340d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"q31", "q32", "0", "0", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0", "0", "1", "0", "0", "0", "0"},
     {"q41", "q42", "0", "0", "0", "0", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0", "1", "0", "0", "0"},
     {"0", "0", "q31", "q32", 
      RowBox[{"-", "q21"}], 
      RowBox[{"-", "q22"}], "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "q41", "q42", "0", "0", 
      RowBox[{"-", "q21"}], 
      RowBox[{"-", "q22"}], "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "q41", "q42", 
      RowBox[{"-", "q31"}], 
      RowBox[{"-", "q32"}], "0", "0", "0", "0", "0", "1"},
     {"q21", "q22", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0", "0", "0", "1", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.925577820353684*^9, 3.925588492998931*^9, {3.925588554278919*^9, 
   3.9255885603217487`*^9}, 3.925588597121891*^9, 3.925597550571229*^9, 
   3.9255980692108393`*^9, 3.925598109635578*^9, 3.925598543504778*^9, 
   3.925598667421487*^9, {3.925598952274755*^9, 3.9255990473027163`*^9}, {
   3.925639740412581*^9, 3.925639768186924*^9}, {3.92563979916903*^9, 
   3.9256398497882338`*^9}, {3.92563995972366*^9, 3.9256400216301126`*^9}, 
   3.9256400583213377`*^9, {3.925640091385625*^9, 3.925640119165019*^9}, {
   3.925640233031831*^9, 3.925640314734329*^9}, {3.925640360873233*^9, 
   3.925640373352131*^9}, {3.925640404198275*^9, 3.925640505057993*^9}, {
   3.9256405693971443`*^9, 3.925640617027256*^9}, {3.925640658808957*^9, 
   3.925640694591001*^9}, {3.925641050150668*^9, 3.9256411275316153`*^9}, {
   3.925641209505619*^9, 3.925641229190782*^9}, {3.9256412859217978`*^9, 
   3.925641292233211*^9}, {3.925641330431147*^9, 3.925641352410399*^9}, 
   3.9256413949858828`*^9, {3.9256414377432833`*^9, 3.925641451285645*^9}, 
   3.9256415546024733`*^9, 3.925641618689211*^9, 3.9256417236184683`*^9, {
   3.9256429072215633`*^9, 3.92564291973177*^9}, {3.9256429648358803`*^9, 
   3.92564298771693*^9}, {3.925643140891343*^9, 3.925643176240343*^9}, 
   3.925643440892791*^9, 3.925645180259605*^9, {3.925645225431714*^9, 
   3.925645237510964*^9}, {3.925645412584852*^9, 3.9256454442770443`*^9}},
 CellLabel->
  "Out[767]//MatrixForm=",ExpressionUUID->"ce27016a-5c02-4198-b688-\
62aab265cff1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", 
      FractionBox[
       RowBox[{"q11", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q11", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", 
      FractionBox["q42", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q32", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0"},
     {"0", "1", "0", "0", 
      FractionBox[
       RowBox[{"q11", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q11", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", 
      FractionBox["q41", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q31", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0"},
     {"0", "0", "1", "0", 
      FractionBox[
       RowBox[{"q21", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q21", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0", 
      FractionBox["q42", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q32", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0"},
     {"0", "0", "0", "1", 
      FractionBox[
       RowBox[{"q21", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q21", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0", 
      FractionBox["q41", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q31", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0"},
     {"0", "0", "0", "0", "q41", "q42", 
      RowBox[{"-", "q31"}], 
      RowBox[{"-", "q32"}], "0", "0", "0", "0", "0", "1"},
     {"q21", "q22", 
      RowBox[{"-", "q11"}], 
      RowBox[{"-", "q12"}], "0", "0", "0", "0", "1", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.925577820353684*^9, 3.925588492998931*^9, {3.925588554278919*^9, 
   3.9255885603217487`*^9}, 3.925588597121891*^9, 3.925597550571229*^9, 
   3.9255980692108393`*^9, 3.925598109635578*^9, 3.925598543504778*^9, 
   3.925598667421487*^9, {3.925598952274755*^9, 3.9255990473027163`*^9}, {
   3.925639740412581*^9, 3.925639768186924*^9}, {3.92563979916903*^9, 
   3.9256398497882338`*^9}, {3.92563995972366*^9, 3.9256400216301126`*^9}, 
   3.9256400583213377`*^9, {3.925640091385625*^9, 3.925640119165019*^9}, {
   3.925640233031831*^9, 3.925640314734329*^9}, {3.925640360873233*^9, 
   3.925640373352131*^9}, {3.925640404198275*^9, 3.925640505057993*^9}, {
   3.9256405693971443`*^9, 3.925640617027256*^9}, {3.925640658808957*^9, 
   3.925640694591001*^9}, {3.925641050150668*^9, 3.9256411275316153`*^9}, {
   3.925641209505619*^9, 3.925641229190782*^9}, {3.9256412859217978`*^9, 
   3.925641292233211*^9}, {3.925641330431147*^9, 3.925641352410399*^9}, 
   3.9256413949858828`*^9, {3.9256414377432833`*^9, 3.925641451285645*^9}, 
   3.9256415546024733`*^9, 3.925641618689211*^9, 3.9256417236184683`*^9, {
   3.9256429072215633`*^9, 3.92564291973177*^9}, {3.9256429648358803`*^9, 
   3.92564298771693*^9}, {3.925643140891343*^9, 3.925643176240343*^9}, 
   3.925643440892791*^9, 3.925645180259605*^9, {3.925645225431714*^9, 
   3.925645237510964*^9}, {3.925645412584852*^9, 3.925645444280272*^9}},
 CellLabel->
  "Out[771]//MatrixForm=",ExpressionUUID->"7efea387-e71b-449f-ad27-\
205734e1a7e9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", 
      FractionBox[
       RowBox[{"q11", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q11", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", 
      FractionBox["q42", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q32", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0"},
     {"0", "1", "0", "0", 
      FractionBox[
       RowBox[{"q11", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q11", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", 
      FractionBox["q41", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q31", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0"},
     {"0", "0", "1", "0", 
      FractionBox[
       RowBox[{"q21", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q21", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0", 
      FractionBox["q42", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q32", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0"},
     {"0", "0", "0", "1", 
      FractionBox[
       RowBox[{"q21", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q21", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0", 
      FractionBox["q41", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q31", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0"},
     {"0", "0", "0", "0", "q41", "q42", 
      RowBox[{"-", "q31"}], 
      RowBox[{"-", "q32"}], "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q12", " ", "q21"}], "-", 
          RowBox[{"q11", " ", "q22"}]}], ")"}], " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q12", " ", "q21"}], "-", 
          RowBox[{"q11", " ", "q22"}]}], ")"}], " ", "q42"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q21", " ", "q31"}], "-", 
        RowBox[{"q11", " ", "q22", " ", "q31"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q21", " ", "q32"}], "-", 
        RowBox[{"q11", " ", "q22", " ", "q32"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "1", 
      FractionBox[
       RowBox[{
        RowBox[{"q22", " ", "q41"}], "-", 
        RowBox[{"q21", " ", "q42"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q22", " ", "q31"}], "-", 
        RowBox[{"q21", " ", "q32"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q41"}], "-", 
        RowBox[{"q11", " ", "q42"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q31"}], "-", 
        RowBox[{"q11", " ", "q32"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.925577820353684*^9, 3.925588492998931*^9, {3.925588554278919*^9, 
   3.9255885603217487`*^9}, 3.925588597121891*^9, 3.925597550571229*^9, 
   3.9255980692108393`*^9, 3.925598109635578*^9, 3.925598543504778*^9, 
   3.925598667421487*^9, {3.925598952274755*^9, 3.9255990473027163`*^9}, {
   3.925639740412581*^9, 3.925639768186924*^9}, {3.92563979916903*^9, 
   3.9256398497882338`*^9}, {3.92563995972366*^9, 3.9256400216301126`*^9}, 
   3.9256400583213377`*^9, {3.925640091385625*^9, 3.925640119165019*^9}, {
   3.925640233031831*^9, 3.925640314734329*^9}, {3.925640360873233*^9, 
   3.925640373352131*^9}, {3.925640404198275*^9, 3.925640505057993*^9}, {
   3.9256405693971443`*^9, 3.925640617027256*^9}, {3.925640658808957*^9, 
   3.925640694591001*^9}, {3.925641050150668*^9, 3.9256411275316153`*^9}, {
   3.925641209505619*^9, 3.925641229190782*^9}, {3.9256412859217978`*^9, 
   3.925641292233211*^9}, {3.925641330431147*^9, 3.925641352410399*^9}, 
   3.9256413949858828`*^9, {3.9256414377432833`*^9, 3.925641451285645*^9}, 
   3.9256415546024733`*^9, 3.925641618689211*^9, 3.9256417236184683`*^9, {
   3.9256429072215633`*^9, 3.92564291973177*^9}, {3.9256429648358803`*^9, 
   3.92564298771693*^9}, {3.925643140891343*^9, 3.925643176240343*^9}, 
   3.925643440892791*^9, 3.925645180259605*^9, {3.925645225431714*^9, 
   3.925645237510964*^9}, {3.925645412584852*^9, 3.9256454442846947`*^9}},
 CellLabel->
  "Out[774]//MatrixForm=",ExpressionUUID->"b445a371-49a7-4e2b-9812-\
67c697b8cf62"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", 
      FractionBox[
       RowBox[{"q11", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q11", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", 
      FractionBox["q42", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q32", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0"},
     {"0", "1", "0", "0", 
      FractionBox[
       RowBox[{"q11", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q11", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q12", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", 
      FractionBox["q41", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q31", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0"},
     {"0", "0", "1", "0", 
      FractionBox[
       RowBox[{"q21", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q42"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q21", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q32"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0", 
      FractionBox["q42", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q32", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0"},
     {"0", "0", "0", "1", 
      FractionBox[
       RowBox[{"q21", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q41"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q21", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{"q22", " ", "q31"}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0", 
      FractionBox["q41", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q31", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0"},
     {"0", "0", "0", "0", "q41", "q42", 
      RowBox[{"-", "q31"}], 
      RowBox[{"-", "q32"}], "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", 
      FractionBox[
       RowBox[{
        RowBox[{"q22", " ", "q41"}], "-", 
        RowBox[{"q21", " ", "q42"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q22", " ", "q31"}], "-", 
        RowBox[{"q21", " ", "q32"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q41"}], "-", 
        RowBox[{"q11", " ", "q42"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q31"}], "-", 
        RowBox[{"q11", " ", "q32"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q21"}], "-", 
        RowBox[{"q11", " ", "q22"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.925577820353684*^9, 3.925588492998931*^9, {3.925588554278919*^9, 
   3.9255885603217487`*^9}, 3.925588597121891*^9, 3.925597550571229*^9, 
   3.9255980692108393`*^9, 3.925598109635578*^9, 3.925598543504778*^9, 
   3.925598667421487*^9, {3.925598952274755*^9, 3.9255990473027163`*^9}, {
   3.925639740412581*^9, 3.925639768186924*^9}, {3.92563979916903*^9, 
   3.9256398497882338`*^9}, {3.92563995972366*^9, 3.9256400216301126`*^9}, 
   3.9256400583213377`*^9, {3.925640091385625*^9, 3.925640119165019*^9}, {
   3.925640233031831*^9, 3.925640314734329*^9}, {3.925640360873233*^9, 
   3.925640373352131*^9}, {3.925640404198275*^9, 3.925640505057993*^9}, {
   3.9256405693971443`*^9, 3.925640617027256*^9}, {3.925640658808957*^9, 
   3.925640694591001*^9}, {3.925641050150668*^9, 3.9256411275316153`*^9}, {
   3.925641209505619*^9, 3.925641229190782*^9}, {3.9256412859217978`*^9, 
   3.925641292233211*^9}, {3.925641330431147*^9, 3.925641352410399*^9}, 
   3.9256413949858828`*^9, {3.9256414377432833`*^9, 3.925641451285645*^9}, 
   3.9256415546024733`*^9, 3.925641618689211*^9, 3.9256417236184683`*^9, {
   3.9256429072215633`*^9, 3.92564291973177*^9}, {3.9256429648358803`*^9, 
   3.92564298771693*^9}, {3.925643140891343*^9, 3.925643176240343*^9}, 
   3.925643440892791*^9, 3.925645180259605*^9, {3.925645225431714*^9, 
   3.925645237510964*^9}, {3.925645412584852*^9, 3.925645444289218*^9}},
 CellLabel->
  "Out[777]//MatrixForm=",ExpressionUUID->"dd013ed7-3e05-42af-973c-\
4405b26bab7b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["q42", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q32", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0"},
     {"0", 
      FractionBox["q41", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q31", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["q42", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q32", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], "0"},
     {"0", "0", "0", 
      FractionBox["q41", 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox["q31", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"1", 
      FractionBox[
       RowBox[{
        RowBox[{"q22", " ", "q41"}], "-", 
        RowBox[{"q21", " ", "q42"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q22", " ", "q31"}], "-", 
        RowBox[{"q21", " ", "q32"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q41"}], "-", 
        RowBox[{"q11", " ", "q42"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q31"}], "-", 
        RowBox[{"q11", " ", "q32"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q32"}], " ", "q41"}], "+", 
        RowBox[{"q31", " ", "q42"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"q12", " ", "q21"}], "-", 
        RowBox[{"q11", " ", "q22"}]}], 
       RowBox[{
        RowBox[{"q32", " ", "q41"}], "-", 
        RowBox[{"q31", " ", "q42"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.925577820353684*^9, 3.925588492998931*^9, {3.925588554278919*^9, 
   3.9255885603217487`*^9}, 3.925588597121891*^9, 3.925597550571229*^9, 
   3.9255980692108393`*^9, 3.925598109635578*^9, 3.925598543504778*^9, 
   3.925598667421487*^9, {3.925598952274755*^9, 3.9255990473027163`*^9}, {
   3.925639740412581*^9, 3.925639768186924*^9}, {3.92563979916903*^9, 
   3.9256398497882338`*^9}, {3.92563995972366*^9, 3.9256400216301126`*^9}, 
   3.9256400583213377`*^9, {3.925640091385625*^9, 3.925640119165019*^9}, {
   3.925640233031831*^9, 3.925640314734329*^9}, {3.925640360873233*^9, 
   3.925640373352131*^9}, {3.925640404198275*^9, 3.925640505057993*^9}, {
   3.9256405693971443`*^9, 3.925640617027256*^9}, {3.925640658808957*^9, 
   3.925640694591001*^9}, {3.925641050150668*^9, 3.9256411275316153`*^9}, {
   3.925641209505619*^9, 3.925641229190782*^9}, {3.9256412859217978`*^9, 
   3.925641292233211*^9}, {3.925641330431147*^9, 3.925641352410399*^9}, 
   3.9256413949858828`*^9, {3.9256414377432833`*^9, 3.925641451285645*^9}, 
   3.9256415546024733`*^9, 3.925641618689211*^9, 3.9256417236184683`*^9, {
   3.9256429072215633`*^9, 3.92564291973177*^9}, {3.9256429648358803`*^9, 
   3.92564298771693*^9}, {3.925643140891343*^9, 3.925643176240343*^9}, 
   3.925643440892791*^9, 3.925645180259605*^9, {3.925645225431714*^9, 
   3.925645237510964*^9}, {3.925645412584852*^9, 3.925645444293088*^9}},
 CellLabel->
  "Out[779]//MatrixForm=",ExpressionUUID->"fec71ead-4758-47b3-9862-\
d928dc922aa5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Generate", " ", 
    RowBox[{"E", "/", "F"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"B", ".", "b"}], " ", "//", " ", "Expand"}], " ", "//", " ", 
      "Simplify"}]}], " ", ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"EoverF", "=", 
    RowBox[{"L", "[", 
     RowBox[{"[", "6", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8866026909206705`*^9, 3.886602707520135*^9}, 
   3.88660284500751*^9, {3.8866073591570663`*^9, 3.886607368476468*^9}, {
   3.8872924429269323`*^9, 3.887292443768456*^9}, {3.887292664183297*^9, 
   3.88729266821734*^9}, {3.887292710656184*^9, 3.8872927887831497`*^9}, {
   3.9038874582984257`*^9, 3.903887477409168*^9}, {3.903887533243563*^9, 
   3.90388753343435*^9}, {3.9038875853720407`*^9, 3.903887599538546*^9}},
 CellLabel->
  "In[780]:=",ExpressionUUID->"79024987-2599-4cf7-9e30-68923851f562"],

Cell["\<\
(1/((-q32)*q41 + q31*q42))*(d11*q22*q31^2*q41 - q32*q41 - d11*q21^2*q32*q41 - \
d13*q21*q22*q32*q41 - d12*q22^2*q32*q41 + d13*q22*q31*q32*q41 + \
d12*q22*q32^2*q41 - 
   d11*q22*q31*q41^2 + d11*q21*q32*q41^2 + q31*q42 + d11*q21^2*q31*q42 + \
d13*q21*q22*q31*q42 + d12*q22^2*q31*q42 - d11*q21*q31^2*q42 - \
d13*q21*q31*q32*q42 - 
   d12*q21*q32^2*q42 - d13*q22*q31*q41*q42 + d13*q21*q32*q41*q42 - \
d12*q22*q31*q42^2 + d12*q21*q32*q42^2 + 
   q11^2*(d41*q22*q31 - d41*q21*q32 - d31*q22*q41 + d21*q32*q41 + d31*q21*q42 \
- d21*q31*q42) + 
   q12^2*(d42*q22*q31 - d42*q21*q32 - d32*q22*q41 + d22*q32*q41 + d32*q21*q42 \
- d22*q31*q42) - 
   q12*((-d43)*q11*q22*q31 + d42*q22^2*q31 + d33*q11*q22*q41 - d32*q22^2*q41 \
+ d21*q31^2*q41 - d23*q11*q32*q41 + d23*q31*q32*q41 + d22*q32^2*q41 - \
d21*q31*q41^2 + 
     q21^2*(d41*q31 - d31*q41) + d23*q11*q31*q42 - d23*q31*q41*q42 - \
d22*q31*q42^2 + q21*(1 + d43*q22*q31 - d41*q31^2 + d43*(q11 - q31)*q32 - \
d42*q32^2 - d33*q22*q41 + 
       d31*q41^2 - d33*q11*q42 + d33*q41*q42 + d32*q42^2)) + \
q11*(d41*q21^2*q32 - d21*q32*q41^2 - d31*q21^2*q42 + d21*q31^2*q42 + \
d23*q31*q32*q42 + d22*q32^2*q42 - 
     d23*q32*q41*q42 - d22*q32*q42^2 + q22^2*(d42*q32 - d32*q42) + q22*(1 - \
d41*q31^2 + d43*(q21 - q31)*q32 - d42*q32^2 + d31*q41^2 - d33*q21*q42 + \
d33*q41*q42 + d32*q42^2)))\
\>", "Output",
 CellChangeTimes->{
  3.9038875344308467`*^9, 3.9038876005902853`*^9, 3.903980557162834*^9, {
   3.925312923036798*^9, 3.925312944938754*^9}, 3.9256452452538548`*^9, 
   3.92564534259169*^9, 3.925645486868731*^9, 3.925645537677706*^9},
 CellLabel->
  "Out[781]=",ExpressionUUID->"f1c23353-3556-4238-bdec-6ad0939cb424"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Generate", " ", "E", " ", "by", " ", "multiplying", " ", 
    RowBox[{"E", "/", "F"}], " ", "by", " ", "F"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Expand", "[", 
   RowBox[{"EoverF", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "q32"}], "*", " ", "q41"}], "+", 
      RowBox[{"q31", "*", " ", "q42"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8866109731351023`*^9, 3.8866109754865417`*^9}, {
   3.9038860595810432`*^9, 3.9038860806758213`*^9}, 3.903887515181952*^9, {
   3.9038875594352894`*^9, 3.9038875790877247`*^9}, {3.9256453352151814`*^9, 
   3.9256453378595324`*^9}},
 CellLabel->
  "In[782]:=",ExpressionUUID->"f7e78d1d-fc72-44e9-a100-4fb3cdabea00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "q12"}], " ", "q21"}], "+", 
  RowBox[{"q11", " ", "q22"}], "-", 
  RowBox[{"d41", " ", "q12", " ", 
   SuperscriptBox["q21", "2"], " ", "q31"}], "+", 
  RowBox[{"d41", " ", 
   SuperscriptBox["q11", "2"], " ", "q22", " ", "q31"}], "+", 
  RowBox[{"d43", " ", "q11", " ", "q12", " ", "q22", " ", "q31"}], "+", 
  RowBox[{"d42", " ", 
   SuperscriptBox["q12", "2"], " ", "q22", " ", "q31"}], "-", 
  RowBox[{"d43", " ", "q12", " ", "q21", " ", "q22", " ", "q31"}], "-", 
  RowBox[{"d42", " ", "q12", " ", 
   SuperscriptBox["q22", "2"], " ", "q31"}], "+", 
  RowBox[{"d41", " ", "q12", " ", "q21", " ", 
   SuperscriptBox["q31", "2"]}], "-", 
  RowBox[{"d41", " ", "q11", " ", "q22", " ", 
   SuperscriptBox["q31", "2"]}], "-", 
  RowBox[{"d41", " ", 
   SuperscriptBox["q11", "2"], " ", "q21", " ", "q32"}], "-", 
  RowBox[{"d43", " ", "q11", " ", "q12", " ", "q21", " ", "q32"}], "-", 
  RowBox[{"d42", " ", 
   SuperscriptBox["q12", "2"], " ", "q21", " ", "q32"}], "+", 
  RowBox[{"d41", " ", "q11", " ", 
   SuperscriptBox["q21", "2"], " ", "q32"}], "+", 
  RowBox[{"d43", " ", "q11", " ", "q21", " ", "q22", " ", "q32"}], "+", 
  RowBox[{"d42", " ", "q11", " ", 
   SuperscriptBox["q22", "2"], " ", "q32"}], "+", 
  RowBox[{"d43", " ", "q12", " ", "q21", " ", "q31", " ", "q32"}], "-", 
  RowBox[{"d43", " ", "q11", " ", "q22", " ", "q31", " ", "q32"}], "+", 
  RowBox[{"d42", " ", "q12", " ", "q21", " ", 
   SuperscriptBox["q32", "2"]}], "-", 
  RowBox[{"d42", " ", "q11", " ", "q22", " ", 
   SuperscriptBox["q32", "2"]}], "+", 
  RowBox[{"d31", " ", "q12", " ", 
   SuperscriptBox["q21", "2"], " ", "q41"}], "-", 
  RowBox[{"d31", " ", 
   SuperscriptBox["q11", "2"], " ", "q22", " ", "q41"}], "-", 
  RowBox[{"d33", " ", "q11", " ", "q12", " ", "q22", " ", "q41"}], "-", 
  RowBox[{"d32", " ", 
   SuperscriptBox["q12", "2"], " ", "q22", " ", "q41"}], "+", 
  RowBox[{"d33", " ", "q12", " ", "q21", " ", "q22", " ", "q41"}], "+", 
  RowBox[{"d32", " ", "q12", " ", 
   SuperscriptBox["q22", "2"], " ", "q41"}], "-", 
  RowBox[{"d21", " ", "q12", " ", 
   SuperscriptBox["q31", "2"], " ", "q41"}], "+", 
  RowBox[{"d11", " ", "q22", " ", 
   SuperscriptBox["q31", "2"], " ", "q41"}], "-", 
  RowBox[{"q32", " ", "q41"}], "+", 
  RowBox[{"d21", " ", 
   SuperscriptBox["q11", "2"], " ", "q32", " ", "q41"}], "+", 
  RowBox[{"d23", " ", "q11", " ", "q12", " ", "q32", " ", "q41"}], "+", 
  RowBox[{"d22", " ", 
   SuperscriptBox["q12", "2"], " ", "q32", " ", "q41"}], "-", 
  RowBox[{"d11", " ", 
   SuperscriptBox["q21", "2"], " ", "q32", " ", "q41"}], "-", 
  RowBox[{"d13", " ", "q21", " ", "q22", " ", "q32", " ", "q41"}], "-", 
  RowBox[{"d12", " ", 
   SuperscriptBox["q22", "2"], " ", "q32", " ", "q41"}], "-", 
  RowBox[{"d23", " ", "q12", " ", "q31", " ", "q32", " ", "q41"}], "+", 
  RowBox[{"d13", " ", "q22", " ", "q31", " ", "q32", " ", "q41"}], "-", 
  RowBox[{"d22", " ", "q12", " ", 
   SuperscriptBox["q32", "2"], " ", "q41"}], "+", 
  RowBox[{"d12", " ", "q22", " ", 
   SuperscriptBox["q32", "2"], " ", "q41"}], "-", 
  RowBox[{"d31", " ", "q12", " ", "q21", " ", 
   SuperscriptBox["q41", "2"]}], "+", 
  RowBox[{"d31", " ", "q11", " ", "q22", " ", 
   SuperscriptBox["q41", "2"]}], "+", 
  RowBox[{"d21", " ", "q12", " ", "q31", " ", 
   SuperscriptBox["q41", "2"]}], "-", 
  RowBox[{"d11", " ", "q22", " ", "q31", " ", 
   SuperscriptBox["q41", "2"]}], "-", 
  RowBox[{"d21", " ", "q11", " ", "q32", " ", 
   SuperscriptBox["q41", "2"]}], "+", 
  RowBox[{"d11", " ", "q21", " ", "q32", " ", 
   SuperscriptBox["q41", "2"]}], "+", 
  RowBox[{"d31", " ", 
   SuperscriptBox["q11", "2"], " ", "q21", " ", "q42"}], "+", 
  RowBox[{"d33", " ", "q11", " ", "q12", " ", "q21", " ", "q42"}], "+", 
  RowBox[{"d32", " ", 
   SuperscriptBox["q12", "2"], " ", "q21", " ", "q42"}], "-", 
  RowBox[{"d31", " ", "q11", " ", 
   SuperscriptBox["q21", "2"], " ", "q42"}], "-", 
  RowBox[{"d33", " ", "q11", " ", "q21", " ", "q22", " ", "q42"}], "-", 
  RowBox[{"d32", " ", "q11", " ", 
   SuperscriptBox["q22", "2"], " ", "q42"}], "+", 
  RowBox[{"q31", " ", "q42"}], "-", 
  RowBox[{"d21", " ", 
   SuperscriptBox["q11", "2"], " ", "q31", " ", "q42"}], "-", 
  RowBox[{"d23", " ", "q11", " ", "q12", " ", "q31", " ", "q42"}], "-", 
  RowBox[{"d22", " ", 
   SuperscriptBox["q12", "2"], " ", "q31", " ", "q42"}], "+", 
  RowBox[{"d11", " ", 
   SuperscriptBox["q21", "2"], " ", "q31", " ", "q42"}], "+", 
  RowBox[{"d13", " ", "q21", " ", "q22", " ", "q31", " ", "q42"}], "+", 
  RowBox[{"d12", " ", 
   SuperscriptBox["q22", "2"], " ", "q31", " ", "q42"}], "+", 
  RowBox[{"d21", " ", "q11", " ", 
   SuperscriptBox["q31", "2"], " ", "q42"}], "-", 
  RowBox[{"d11", " ", "q21", " ", 
   SuperscriptBox["q31", "2"], " ", "q42"}], "+", 
  RowBox[{"d23", " ", "q11", " ", "q31", " ", "q32", " ", "q42"}], "-", 
  RowBox[{"d13", " ", "q21", " ", "q31", " ", "q32", " ", "q42"}], "+", 
  RowBox[{"d22", " ", "q11", " ", 
   SuperscriptBox["q32", "2"], " ", "q42"}], "-", 
  RowBox[{"d12", " ", "q21", " ", 
   SuperscriptBox["q32", "2"], " ", "q42"}], "-", 
  RowBox[{"d33", " ", "q12", " ", "q21", " ", "q41", " ", "q42"}], "+", 
  RowBox[{"d33", " ", "q11", " ", "q22", " ", "q41", " ", "q42"}], "+", 
  RowBox[{"d23", " ", "q12", " ", "q31", " ", "q41", " ", "q42"}], "-", 
  RowBox[{"d13", " ", "q22", " ", "q31", " ", "q41", " ", "q42"}], "-", 
  RowBox[{"d23", " ", "q11", " ", "q32", " ", "q41", " ", "q42"}], "+", 
  RowBox[{"d13", " ", "q21", " ", "q32", " ", "q41", " ", "q42"}], "-", 
  RowBox[{"d32", " ", "q12", " ", "q21", " ", 
   SuperscriptBox["q42", "2"]}], "+", 
  RowBox[{"d32", " ", "q11", " ", "q22", " ", 
   SuperscriptBox["q42", "2"]}], "+", 
  RowBox[{"d22", " ", "q12", " ", "q31", " ", 
   SuperscriptBox["q42", "2"]}], "-", 
  RowBox[{"d12", " ", "q22", " ", "q31", " ", 
   SuperscriptBox["q42", "2"]}], "-", 
  RowBox[{"d22", " ", "q11", " ", "q32", " ", 
   SuperscriptBox["q42", "2"]}], "+", 
  RowBox[{"d12", " ", "q21", " ", "q32", " ", 
   SuperscriptBox["q42", "2"]}]}]], "Output",
 CellChangeTimes->{
  3.903887515785796*^9, 3.9038875797831182`*^9, 3.9039805572314653`*^9, {
   3.925312923050352*^9, 3.925312944952118*^9}, 3.925645251130047*^9, 
   3.925645338707254*^9, 3.9256454912274303`*^9},
 CellLabel->
  "Out[782]=",ExpressionUUID->"1282f6d6-4689-4876-8592-f765606a06c3"]
}, Open  ]]
},
WindowSize->{1286.25, 732.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (August 22, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5b0e0d01-f0a9-4546-bc11-122e9c43f751"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 383, 8, 21, "Input",ExpressionUUID->"b83518cd-3f38-4a2a-a3ea-bc9b5109c4dd"],
Cell[CellGroupData[{
Cell[966, 32, 3733, 104, 351, "Input",ExpressionUUID->"5379b353-df5b-421a-a41c-5a288af45ec0"],
Cell[4702, 138, 1355, 38, 98, "Output",ExpressionUUID->"c9c67863-3b09-4c1f-8a11-279b047b2935"]
}, Open  ]],
Cell[6072, 179, 2269, 56, 94, "Input",ExpressionUUID->"7bf4ba82-2376-410a-9607-2bb0a710f38a"],
Cell[CellGroupData[{
Cell[8366, 239, 547, 12, 36, "Input",ExpressionUUID->"2243a51f-9afc-44e3-b25a-4d617b8c0633"],
Cell[8916, 253, 722, 14, 24, "Output",ExpressionUUID->"56ae167d-d612-4401-b651-6efb0ce79c3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9675, 272, 1021, 21, 50, "Input",ExpressionUUID->"c9e6775f-d92f-4489-8ecf-5a7fad82785a"],
Cell[10699, 295, 6022, 183, 146, "Output",ExpressionUUID->"29b4eb5a-25f0-410d-8d08-d054b1779725"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16758, 483, 9373, 212, 464, "Input",ExpressionUUID->"8c05cc0d-c312-4960-86bd-da37261b718d"],
Cell[26134, 697, 2736, 54, 98, "Output",ExpressionUUID->"0fb0e066-b1ab-454f-82b8-a8558d58340d"],
Cell[28873, 753, 2738, 54, 98, "Output",ExpressionUUID->"ce27016a-5c02-4198-b688-62aab265cff1"],
Cell[31614, 809, 6212, 170, 138, "Output",ExpressionUUID->"7efea387-e71b-449f-ad27-205734e1a7e9"],
Cell[37829, 981, 8144, 232, 148, "Output",ExpressionUUID->"b445a371-49a7-4e2b-9812-67c697b8cf62"],
Cell[45976, 1215, 7275, 205, 148, "Output",ExpressionUUID->"dd013ed7-3e05-42af-973c-4405b26bab7b"],
Cell[53254, 1422, 4367, 115, 148, "Output",ExpressionUUID->"fec71ead-4758-47b3-9862-d928dc922aa5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57658, 1542, 982, 22, 50, "Input",ExpressionUUID->"79024987-2599-4cf7-9e30-68923851f562"],
Cell[58643, 1566, 1668, 31, 126, "Output",ExpressionUUID->"f1c23353-3556-4238-bdec-6ad0939cb424"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60348, 1602, 768, 18, 36, "Input",ExpressionUUID->"f7e78d1d-fc72-44e9-a100-4fb3cdabea00"],
Cell[61119, 1622, 6375, 132, 99, "Output",ExpressionUUID->"1282f6d6-4689-4876-8592-f765606a06c3"]
}, Open  ]]
}
]
*)

